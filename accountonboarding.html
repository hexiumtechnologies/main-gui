<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Create Account</title>
<style>
  /* Ensure background color is applied correctly */
  body {
    background-color: #f0f2f5; /* your desired background */
    margin: 0;
    font-family: 'Roboto', sans-serif;
  }
  .container {
    max-width: 400px;
    margin: 3rem auto;
    padding: 2rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  img.logo {
    display: block;
    margin: 0 auto 1rem auto;
    width: 80px;
    height: auto;
  }
  form > div {
    margin-bottom: 1rem;
  }
  label {
    display: block;
    font-weight: 500;
    margin-bottom: 0.25rem;
  }
  input {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  button {
    width: 100%;
    padding: 0.75rem;
    font-size: 1rem;
    background-color: #007bff;
    border: none;
    color: white;
    border-radius: 4px;
    cursor: pointer;
  }
  button:disabled {
    background-color: #999;
    cursor: not-allowed;
  }
  .message {
    margin-top: 1rem;
    font-weight: 600;
  }
</style>
</head>
<body>
  <div class="container">
    <img class="logo" src="/img/logo.svg" alt="Logo" />
    <form id="createAccountForm">
      <div>
        <label for="username">Username</label>
        <input id="username" name="username" type="text" required autocomplete="username" />
      </div>
      <div>
        <label for="password">Password</label>
        <input id="password" name="password" type="password" required autocomplete="new-password" />
      </div>
      <div>
        <label for="birthday">Birthday (YYYY-MM-DD)</label>
        <input id="birthday" name="birthday" type="date" pattern="\d{4}-\d{2}-\d{2}" required />
      </div>
      <button type="submit">Create Account</button>
    </form>
    <div class="message" id="message"></div>
  </div>

  <script>
    const form = document.getElementById('createAccountForm');
    const messageEl = document.getElementById('message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      messageEl.textContent = '';
      
      const username = form.username.value.trim();
      const password = form.password.value.trim();
      const birthday = form.birthday.value;

      if (!username || !password || !birthday) {
        messageEl.textContent = 'Please fill out all required fields.';
        messageEl.style.color = 'red';
        return;
      }

      // Construct the URL with params
      const url = new URL('/api/accounts/new', window.location.origin);
      url.searchParams.set('username', username);
      url.searchParams.set('password', password);
      url.searchParams.set('school', 'null'); // as requested
      url.searchParams.set('birthday', birthday);

      try {
        const res = await fetch(url, {
          method: 'GET',
          headers: {
            'Accept': 'application/json'
          }
        });
        if (!res.ok) throw new Error(`Server error: ${res.status}`);

        const data = await res.json();
        // Assuming API returns success or error message
        messageEl.textContent = data.message || 'Account created successfully!';
        messageEl.style.color = 'green';

        form.reset();
      } catch (err) {
        messageEl.textContent = `Error: ${err.message}`;
        messageEl.style.color = 'red';
      }
    });
  </script>
</body>
</html>
